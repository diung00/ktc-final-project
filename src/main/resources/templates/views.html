<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChoiGangDelivery</title>
    <style>
        /* common */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
        }

        /* Header */
        .header {
            background-color: #f3067d;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-size: 24px;
        }

        .header .site-name {
            font-weight: bold;
            color: white;
            text-decoration: none;
        }

        .header .login-link {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 20px;
            background-color: #f3067d;
            font-weight: bold;
        }

        .header .login-link:hover {
            background-color: #ff69b4;
        }

        /* Search Restaurant by Cuisine type */
        .search-section {
            text-align: center;
            background-image: url('img\search-home.jpg');
            background-size: cover;
            background-position: center;
            padding: 60px 20px; /* Điều chỉnh khoảng cách trên và dưới */
            color: white; /* Chữ trắng cho dễ đọc trên nền tối */
        }

        .search-section input[type="text"] {
            width: 80%;
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ff69b4; /* Màu hồng cho border */
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.8); /* Nền trắng trong suốt cho ô tìm kiếm */
        }

        .search-section button {
            padding: 10px 20px;
            background-color: #ff69b4; /* Màu hồng */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .search-section button:hover {
            background-color: #ff1493; /* Màu hồng đậm hơn khi hover */
        }

        /* Phần phân loại nhà hàng */
        .categories {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 20px;
        }

        .category-item {
            width: 18%;
            margin: 10px;
            text-align: center;
        }

        .category-item img {
            width: 100%;
            height: auto;
            border-radius: 10px;
            transition: transform 0.3s;
        }

        .category-item img:hover {
            transform: scale(1.05);
        }

        .category-item p {
            font-weight: bold;
            color: #ff1493; /* Màu chữ cho tên món ăn */
            margin-top: 8px;
        }
    </style>
</head>
<body>
<!-- Header -->
<div class="header">
    <a href="#" class="site-name">ChoiGangDelivery</a>
    <a href="/views/get-my-profile">내 프로필</a> <!-- My Profile -->
    <a href="/views/list-restaurant">주변 식당 보기</a>
</div>

<!-- Phần tìm kiếm nhà hàng -->
<div class="search-section">
    <input type="text" id="searchInput" placeholder="레스토랑을 찾으려면 주소를 입력하세요..."> <!-- Nhập tên món ăn để tìm kiếm -->
    <button id="searchButton">검색</button> <!-- Tìm kiếm -->
</div>


<div id="restaurant-list-by-menu">
    <!-- Các nhà hàng sẽ được hiển thị ở đây -->
</div>

<!-- Phần phân loại nhà hàng -->
<div class="categories">
    <!-- Mỗi mục nhà hàng -->
    <div class="category-item">
        <img src="static/img/images/한식.jpg" alt="한식">
        <p> 한식 </p>
    </div>
    <div class="category-item">
        <img src="static/img/images/일식.jpg" alt="일식">
        <p>일식</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/중식.jpg" alt="중식">
        <p>중식</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/양식.jpg" alt="양식">
        <p>양식</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/패스트푸드.jpg" alt="패스트푸드">
        <p>패스트푸드</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/치킨.jpg" alt="치킨">
        <p>치킨</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/피자.jpg" alt="피자">
        <p>피자</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/동남아 음식.jpg" alt="동남아 음식">
        <p>동남아 음식</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/카페 - 디저트.jpg" alt="카페/디저트">
        <p>카페/디저트</p>
    </div>
    <div class="category-item">
        <img src="static/img/images/기타 세계 음식.jpg" alt="기타 세계 음식">
        <p>기타 세계 음식</p>

    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const jwt = localStorage.getItem("token");
        if (!jwt) {
            location.href = "/views/login";
        }

        const searchButton = document.getElementById("searchButton");
        const searchInput = document.getElementById("searchInput");

        const validCuisineTypes = [
            "KOREAN_FOOD",
            "JAPANESE_FOOD",          // (일식)
            "CHINESE_FOOD",           // (중식)
            "WESTERN_FOOD",           // (양식)
            "FAST_FOOD",              // (패스트푸드)
            "CAFE_DESSERT",           // (카페/디저트)
            "CHICKEN",                // 치킨)
            "PIZZA",                  // (피자)
            "ASIAN_FOOD",             // (동남아 음식)
            "INTERNATIONAL_FOOD"      // 기타 세계 음식
        ];

        searchButton.addEventListener("click", () => {
            const searchTerm = searchInput.value.trim(); // Lấy giá trị từ ô input

            if (!searchTerm) {
                alert("Please enter a search term.");
                return;
            }

            const isCuisineSearch = validCuisineTypes.some(cuisine => cuisine.toLowerCase() === searchTerm.toLowerCase());
            const isMenuSearch = !isCuisineSearch;

            let fetchApi;

            if (isMenuSearch) {
                // Fetch API tìm kiếm theo tên món ăn
                fetchApi = fetch(`/restaurants/within-radius/menu?menuName=${searchTerm}`, {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${jwt}`,
                    },
                });
            } else if (isCuisineSearch) {
                // Fetch API tìm kiếm theo loại món ăn
                fetchApi = fetch(`/restaurants/within-radius/cuisine?cuisineType=${searchTerm}`, {
                    method: "GET",
                    headers: {
                        "Authorization": `Bearer ${jwt}`,
                    },
                });
            } else {
                alert("유효한 검색어를 입력해주세요 (메뉴 이름 또는 요리 유형)");
                return;
            }
            fetchApi
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json();
                })
                .then(data => {
                    const restaurantList = document.getElementById("restaurant-list-by-menu");
                    restaurantList.innerHTML = "";  // Xóa kết quả cũ

                    if (data.length === 0) {
                        restaurantList.innerHTML = "<p>일치한 결과가 없습니다!</p>";
                    } else {
                        data.forEach(restaurant => {
                            const restaurantDiv = document.createElement("div");
                            restaurantDiv.classList.add("restaurant");
                            restaurantDiv.innerHTML = `
                            <h2><a href="/views/get-one-restaurant?id=${restaurant.id}">${restaurant.name}</a></h2>
                            <p>Address: ${restaurant.address}</p>
                            <p>Phone: ${restaurant.phone}</p>
                            <p>Opening Hours: ${restaurant.openingHours}</p>
                            <p>Cuisine: ${restaurant.cuisineType}</p>
                            <p>Rating: ${restaurant.rating}</p>
                            <img src="${restaurant.restImage}" alt="${restaurant.name}" />
                            <p>${restaurant.description}</p>
                            <p>Status: ${restaurant.approvalStatus}</p>
                        `;

                            restaurantList.appendChild(restaurantDiv);
                        });
                    }
                })
                .catch(error => {
                    console.error("Fetch error:", error);
                    alert("An error occurred while fetching restaurant data.");
                });
        });
    });
</script>

</body>
</html>
